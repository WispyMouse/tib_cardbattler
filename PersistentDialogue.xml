<?xml version="1.0" encoding="utf-8"?>
<PersistentDialogue desc="Dialogue and scripts that are universally available in every scene in the campaign (e.g. death monologues or scripts used in items and skills)." campaign="TIB Card Battler" lastEdited="6/17/2025 6:26:24 PM">

	<Script>TrySetPlayerStartingDeck
		<Action>SetList/StartingDeck,Awareness|Bandit|Bandit|Bandit|Bandit|Barudit|Barudit|Gasul|Bowman|Frost Armor|Fury|Leap|Merchant|Mind Blast|Mind Blast|Mind Shield|Mind Shield|Shadowling|Shadowling|Solid State Shield|Swordsman|Swordsman|Terror</Action>
		<Action>SetVal/DeckLastIndex,=:LASTINLIST[PlayerDeck]</Action>
		<Action>IfValRun/DeckLastIndex,l,0,_ConfirmedSetPlayerStartingDeck</Action>
	</Script>

	<Script>_ConfirmedSetPlayerStartingDeck
		<Action>SetList/PlayerDeck,</Action>
		<Action>CombineLists/PlayerDeck,StartingDeck,PlayerDeck</Action>
	</Script>

	<Script>ConfigureCardData
		<Action>SetList/AllCards,Assassin|Bakery|Bandit|Barudit|Bowman|Crossbowman|Cryokineticist|Drake|Gasul|Golem|Greater Spriggat|Iron Jaw Trap|Library|Mantis Rider|Mentalist|Merchant|Photokineticist|Pyrokineticist|Psy Healer|Smuggler|Solid State Shield|Shadowling|Spearman|Spirit|Spriggat|Steam Engine|Swordsman|Awareness|Blinding Cloak|Dark Vortex|Drain|Feedback|Focus|Frost Armor|Fury|Kinetic Gust|Leap|Light Blast|Mind Blast|Mind Control|Mind Shield|Shadow Blast|Stimulate|Terror</Action>
		<Action>SetList/AllCardsToRarity,1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2|3|1|2</Action>
		<Action>SetList/RarityToName,Starter|Common|Uncommon|Rare</Action>
		<Action>SetList/RarityToCost,1|2|5|15</Action>
		<Action>Log/Loaded cards to index LASTINLIST[AllCards]</Action>
	</Script>

	<Script>GetCardDataByIndex
		<Action>Log/Fetching card information from AllCards list at index -VAL:Index-.</Action>
		<Action>SetString/CardName,LIST{AllCards,-VAL:Index-}</Action>
		<Action>SetVal/Rarity,=:LIST{AllCardsToRarity,-VAL:Index-}</Action>
		<Action>SetString/RarityName,LIST{RarityToName,-VAL:Rarity-}</Action>
		<Action>SetVal/RarityCost,=:LIST{RarityToCost,-VAL:Rarity-}</Action>
	</Script>

	<Script>RunAllInitializers
		<Action>IfValRun/OneTimeStartupFlag,=,0,OneTimeInitializers</Action>
	</Script>

	<Script>OneTimeInitializers
		<Action>SetVal/OneTimeStartupFlag,=:1</Action>
		<Action>SwitchRoster/0</Action>
		<Action>Run/TrySetPlayerStartingDeck</Action>
		<Action>Run/ConfigureCardData</Action>
		<Action>SetAura/=:100</Action>
		<Action>ClearRoster/0</Action>
		<Action>Recruit/Spirit of Card Playing/,0</Action>
		<Action>SetList/PlayerDeckInactive</Action>
	</Script>

	<Script>GainPsyClashCard
		<Action>AddToList/PlayerDeck,-STR:Name-</Action>
	</Script>

	<Script>GetCardIndexByName
		<Action>SetVal/MatchingIndex,=:-1</Action>
		<Action>ForLoop/-ii-,0-LASTINLIST[AllCards],1,Run,_GetCardIndexByNameForIndexAbortIfFound,CardNameToFind,-STR:CardNameToFind-,Index,-ii-</Action>
		<Action>Log/After looking for the index of -STR:CardNameToFind-, the matching index was found at (or not found as -1): '-VAL:MatchingIndex-'</Action>
	</Script>

	<Script>_SetVal
		<Action>SetVal/-STR:Variable Name-,-STR:Operator-:-VAL:Amount-</Action>
	</Script>

	<Script>_GetCardIndexByNameForIndex
		<Action>Run/GetCardDataByIndex,Index,-VAL:Index-</Action>
		<Action>IfStringRun/-STR:CardNameToFind-,-STR:CardName-,_SetVal,,Variable Name,MatchingIndex,Operator,=,Amount,-VAL:Index-</Action>
	</Script>

	<Script>_GetCardIndexByNameForIndexAbortIfFound
		<Action>IfValRun/MatchingIndex,=,-1,_GetCardIndexByNameForIndex,CardNameToFind,-STR:CardNameToFind-,Index,-VAL:Index-</Action>
	</Script>

	<Dialogue trigger="OnTurn/0" convID="Initialization" r="false">
		<Branch num="0" name="">/The player should not see this initialization prompt. This has turn 0 so it can load during conversations.
			<Action>Run/RunAllInitializers</Action>
			<Action>EndConvImmediately/</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="OnLoaded/" convID="Battle Initialization" r="false">
		<Branch num="0" name="">/The player should not see this initialization prompt. This one exists so that it can load in battle before turn 0.
			<Action>LoadConv/Initialization</Action>
			<Action>EndConvImmediately/</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

</PersistentDialogue>