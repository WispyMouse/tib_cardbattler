<?xml version="1.0" encoding="utf-8"?>
<Level mapname="Play Random Encounter" maptype="Cut Scene: Static" maxplayers="1" musictrack="" winAura="0" nextbattle="Main Game Loop" saveable="true" campaign="TIB Card Battler" lastEdited="6/19/2025 7:26:07 AM">

	<Narration> -PIC:Tavern_Dingy-   -DIA:Pick and Play-</Narration>

	<Script>PickRandomEncounter
		<Action>SetList/ValidEncounters,</Action>
		<Action>Run/PickEncounterListName</Action>
		<Action>CombineLists/ValidEncounters,-STR:EncounterListName,Week-,ValidEncounters</Action>
		<Action>SetVal/RandomEncounterIndex,=:RANGE[0-LASTINLIST[ValidEncounters]]</Action>
		<Action>Log/The last valid index for an encounter is 'LASTINLIST[ValidEncounters]'. Setting RandomEncounterIndex to '-VAL:RandomEncounterIndex-'.</Action>
		<Action>SetString/RandomEncounterConvId,LIST{Encounters,-VAL:RandomEncounterIndex-}</Action>
		<Action>Log/Chosen ID is '-STR:RandomEncounterConvId-'</Action>
	</Script>

	<Script>EnumerateAllEncounters
		<Action>IfValRun/EncountersEnumerated,=,0,_EnumerateAllEncountersConfirm</Action>
	</Script>

	<Script>_EnumerateAllEncountersConfirm
		<Action>ForLoop/-ii-,0-LASTINLIST[Encounters],1,Run,AddChooseableEncounter,EncounterIndex,-ii-</Action>
	</Script>

	<Script>AddChooseableEncounter
		<Action>AddReply/,,LIST{Encounters,-VAL:EncounterIndex-}|LoadConv|LIST{Encounters,-VAL:EncounterIndex-}</Action>
	</Script>

	<Script>PickEncounterListName
		<Action>SetVal/DaysPassed,=:-DAYSPASSED-</Action>
		<Action>SetVal/MaxWeekNumber,=:1</Action>
		<Action>IfValRun/DaysPassed,g=,7,_SetVal,VariableName,MaxWeekNumber,Amount,2</Action>
		<Action>IfValRun/DaysPassed,g=14,_SetVal,VariableName,MaxWeekNumber,Amount,3</Action>
		<Action>IfValRun/DaysPassed,g=,21,_SetVal,VariableName,MaxWeekNumber,Amount,4</Action>
		<Action>SetString/Pool,</Action>
		<Action>SetVal/DayOfTheWeek,=:-DAYOFTHEWEEK-</Action>
		<Action>IfValRun/DayOfTheWeek,=:0,_SetString,Variable Name,Pool,String,Novice</Action>
		<Action>IfValRun/DayOfTheWeek,=:1,_SetString,Variable Name,Pool,String,Novice</Action>
		<Action>IfValRun/DayOfTheWeek,=:2,_SetString,Variable Name,Pool,String,Intermediate</Action>
		<Action>IfValRun/DayOfTheWeek,=:3,_SetString,Variable Name,Pool,String,Intermediate</Action>
		<Action>IfValRun/DayOfTheWeek,=:4,_SetString,Variable Name,Pool,String,Intermediate</Action>
		<Action>IfValRun/DayOfTheWeek,=:5,_SetString,Variable Name,Pool,String,Expert</Action>
		<Action>IfValRun/DayOfTheWeek,=:6,_SetString,Variable Name,Pool,String,Expert</Action>
		<Action>SetString/EncounterListName,Week-VAL:MaxWeekNumber--STR:Pool-Encounters</Action>
		<Action>Log/Pool: '-STR:Pool-' ; DaysPassed: '-VAL:DaysPassed- ; MaxWeekNumber: '-VAL:MaxWeekNumber-' ; EncounterListName -STR:EncounterListName-'</Action>
	</Script>

	<Dialogue trigger="None/" convID="Pick and Play" r="true">
		<Branch num="1" name="">/This is where you'd have some random encounter. For now, choose!
			<Action>Run/RunAllInitializers</Action>
			<Action>Run/ShowButtons</Action>
			<Action>SetVal/EncountersEnumerated,=:0</Action>
			<Reply>Skip The Day/LoadConv/Skip Day</Reply>
			<Reply>Play Random Encounter/LoadConv/Random Encounter</Reply>
			<Reply>Choose Specific Encounter/NamedBranch/Choose</Reply>
		</Branch>
		<Branch num="1" name="Choose">/Pick any encounter
			<Action>Run/EnumerateAllEncounters</Action>
			<Reply>Back/NewBranch/0</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Bandit Deck Battle" r="true">
		<Branch num="2" name="">-STR:_GeneratedUnit-/I really like bandits. My entire deck, all bandits!
			<Action>SetString/ChosenClass,PICK{Assassin|Axefighter|Cavalier|Swordsman|Engineer|Spearman|Mentalist|Kineticist|Pyrokineticist|Cryokineticist|Photokineticist|Skiakineticist|Psy Healer|Gasul|Barudit|Dark Spriggat|Golden Spriggat|Red Spriggat|Frost Spriggat}</Action>
			<Action>SetString/OpponentColor,PICK{Red|Orange|Yellow|Green|White|Black|Violet}</Action>
			<Action>GenerateUnique/1,-STR:ChosenClass-,1,RANDOM,,,-1,-1,Down,,,,false,100,0,-1</Action>
			<Action>SetList/OpponentDeck,Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit|Bandit</Action>
			<Action>AddPortrait/-STR:_GeneratedUnit-,-STR:_GeneratedUnit-,right</Action>
			<Action>SetString/OpponentName,-STR:_GeneratedUnit-</Action>
			<Reply>Fight on!/NextBranch</Reply>
		</Branch>
		<Branch num="3" name="">/Player should not see this or the reply. The reply is empty because otherwise it would execute after first opponent turn.
			<Action>CardGame/Encounter Win,Encounter Lost,PlayerDeck,-STR:_GeneratedUnit-,-STR:OpponentColor-,20,0,OpponentDeck,-STR:_GeneratedUnit-,1,2</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Starter Deck Battle" r="true">
		<Branch num="2" name="">Rohit/I have Rohit's deck, which is the starting deck. Good luck, have fun!
			<Action>AddPortrait/Rohit,Villager Dese M,right</Action>
			<Action>SetString/OpponentName,Rohit</Action>
			<Action>SetList/OpponentDeck,Awareness|Bandit|Bandit|Bandit|Bandit|Barudit|Barudit|Bowman|Frost Armor|Fury|Leap|Merchant|Mind Blast|Mind Blast|Mind Shield|Mind Shield|Shadowling|Shadowling|Solid State Shield|Swordsman|Swordsman|Terror</Action>
			<Reply>Fight on!/NextBranch</Reply>
		</Branch>
		<Branch num="3" name="">/Player should not see this or the reply. The reply is empty because otherwise it would execute after first opponent turn.
			<Action>CardGame/Encounter Win,Encounter Lost,PlayerDeck,Rohit,Red,20,0,StartingDeck,Rohit,1,2</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Tourney Three Deck Battle" r="true">
		<Branch num="2" name="">-STR:_GeneratedUnit-/I'm pretty tough. Good luck!
			<Action>SetString/ChosenClass,PICK{Assassin|Axefighter|Cavalier|Swordsman|Engineer|Spearman|Mentalist|Kineticist|Pyrokineticist|Cryokineticist|Photokineticist|Skiakineticist|Psy Healer|Gasul|Barudit|Dark Spriggat|Golden Spriggat|Red Spriggat|Frost Spriggat}</Action>
			<Action>SetString/OpponentColor,PICK{Red|Orange|Yellow|Green|White|Black|Violet}</Action>
			<Action>GenerateUnique/1,-STR:ChosenClass-,1,RANDOM,,,-1,-1,Down,,,,false,100,0,-1</Action>
			<Action>SetList/OpponentDeck,Barudit|Barudit|Barudit|Barudit|Drake|Drake|Bowman|Bowman|Frost Armor|Frost Armor|Fury|Fury|Fury|Fury|Leap|Leap|Smuggler|Smuggler|Focus|Focus|Focus|Focus|Stimulate|Stimulate|Spriggat|Spriggat|Spearman|Spearman|Feedback|Feedback|Shadow Blast|Shadow Blast|Dark Vortex</Action>
			<Action>AddToList/OpponentDeck,PICK{Spirit|Smuggler}</Action>
			<Action>AddToList/OpponentDeck,PICK{Bakery|Steam Engine}</Action>
			<Action>AddToList/OpponentDeck,PICK{Feedback|Light Blast|Shadow Blast|Kinetic Gust}</Action>
			<Action>AddToList/OpponentDeck,PICK{Dark Vortex|Drake|Mantis Rider|Crossbowman}</Action>
			<Action>AddToList/OpponentDeck,PICK{Dark Vortex|Drake|Mantis Rider|Crossbowman}</Action>
			<Action>AddPortrait/-STR:_GeneratedUnit-,-STR:_GeneratedUnit-,right</Action>
			<Action>SetString/OpponentName,-STR:_GeneratedUnit-</Action>
			<Reply>Fight on!/NextBranch</Reply>
		</Branch>
		<Branch num="3" name="">/Player should not see this or the reply. The reply is empty because otherwise it would execute after first opponent turn.
			<Action>CardGame/Encounter Win,Encounter Lost,PlayerDeck,-STR:_GeneratedUnit-,-STR:OpponentColor-,20,0,OpponentDeck,-STR:_GeneratedUnit-,1,2</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Dusht Deck Battle" r="true">
		<Branch num="2" name="">Dusht/I have Dusht's deck, full of real haymakers.
			<Action>AddPortrait/Dusht,Dusht,right</Action>
			<Action>SetString/OpponentName,Dusht</Action>
			<Action>SetList/OpponentDeck,Barudit|Barudit|Barudit|Assassin|Assassin|Assassin|Bowman|Bowman|Iron Jaw Trap|Iron Jaw Trap|Iron Jaw Trap|Fury|Fury|Fury|Smuggler|Smuggler|Mentalist|Mentalist|Focus|Focus|Focus|Focus|Drain|Drain|Blinding Cloak|Blinding Cloak|Spirit|Spirit|Spirit|Feedback|Feedback|Kinetic Gust|Kinetic Gust|Mind Control|Library|Library</Action>
			<Reply>Fight on!/NextBranch</Reply>
		</Branch>
		<Branch num="3" name="">/Player should not see this or the reply. The reply is empty because otherwise it would execute after first opponent turn.
			<Action>CardGame/Encounter Win,Encounter Lost,PlayerDeck,Rohit,Orange,20,0,OpponentDeck,Rohit,1,2</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Sita Deck Battle" r="true">
		<Branch num="2" name="">Sita/I have Sita's deck. Ahahaha, have fun.
			<Action>AddPortrait/Sita,Sita,right</Action>
			<Action>SetString/OpponentName,Sita</Action>
			<Action>SetList/OpponentDeck,Barudit|Barudit|Barudit|Barudit|Drake|Drake|Bowman|Bowman|Frost Armor|Frost Armor|Fury|Fury|Fury|Fury|Leap|Leap|Smuggler|Smuggler|Focus|Focus|Focus|Focus|Stimulate|Stimulate|Spriggat|Spriggat|Spearman|Spearman|Feedback|Feedback|Shadow Blast|Shadow Blast|Dark Vortex</Action>
			<Reply>Fight on!/NextBranch</Reply>
		</Branch>
		<Branch num="3" name="">/Player should not see this or the reply. The reply is empty because otherwise it would execute after first opponent turn.
			<Action>CardGame/Encounter Win,Encounter Lost,PlayerDeck,Sita,Green,20,0,OpponentDeck,Sita,1,2</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Encounter Win" r="true">
		<Branch num="0" name="">-STR:OpponentName-/This is the encounter win dialogue. Wow, good job!
			<Action>ClearPortraits/</Action>
			<Action>AddPortrait/-STR:OpponentName-,-STR:OpponentName-,left</Action>
			<Action>AddDayLog/Battle,Victorious versus -STR:OpponentName- in a random encounter</Action>
			<Reply>Thanks!/NextBranch</Reply>
		</Branch>
		<Branch num="1" name="">/The player should not see this text, because it should immediately load a new scene.
			<Action>NewScene/Main Game Loop</Action>
			<Action>ClearQueue/</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Encounter Lost" r="true">
		<Branch num="0" name="">-STR:OpponentName-/Too bad this is the lose dialogue.
			<Action>AddPortrait/-STR:OpponentName-,-STR:OpponentName-,left</Action>
			<Action>AddDayLog/Battle,Defeated by -STR:OpponentName- in a random encounter</Action>
			<Reply>Darn/NextBranch</Reply>
		</Branch>
		<Branch num="1" name="">/The player should not see this text, because it should immediately load a new scene.
			<Action>NewScene/Main Game Loop</Action>
			<Action>ClearQueue/</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Skip Day" r="true">
		<Branch num="0" name="">/The player should not see this text, because it should immediately load a new scene.
			<Action>SetVal/UpdateDaysPassed,+:1</Action>
			<Action>AddDayLog/Event,Skipped the day</Action>
			<Action>NewScene/Main Game Loop</Action>
			<Action>EndConvImmediately/</Action>
			<Action>ClearQueue/</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

	<Dialogue trigger="None/" convID="Random Encounter" r="true">
		<Branch num="0" name="">/The player should not see this text, because it should immediately load the random encounter.
			<Action>SetVal/UpdateDaysPassed,+:1</Action>
			<Action>Run/PickRandomEncounter</Action>
			<Action>LoadConv/-STR:RandomEncounterConvId-</Action>
			<Action>EndConvImmediately/</Action>
			<Reply>/</Reply>
		</Branch>
	</Dialogue>

</Level>